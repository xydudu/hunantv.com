window.HN&&window.jQuery&&HN.ajax&&(HN.autocomplete=function($target,$url,$option){HN.debug('autocomplete is init!');var options={boxId:'autocomplete-box',liclass:'li-selected'},current=-1,count=0,setTimeoutobj,cvalue;if(HN.isString($option)){options.boxId=$option;}else if(typeof $option=='object'){$.extend(options,$option);}
$target.keyup(function(event){var keycode=event.keyCode,offset='',width='',height='',o=$(this);offset==''?offset=$target.offset():'';width==''?width=$target.width():'';height==''?height=$target.height():'';if(keycode==40){selected(++current);}else if(keycode==38){selected(--current);}else if(keycode==13){$('#'+options.boxId).hide();}else{if(o.val().replace(' ','').length>=1){if(o.val()!=cvalue){var
data={key:o.val()},url=$url;HN.ajax.post(url,data,function($data){count=$data.length;showlist($data);cvalue=o.val();});}}else{o.val('');}}
function selected($current){if($current<0){current=0};if($current>=count){current=(count-1)}
$('#'+options.boxId).find('li').removeClass(options.liclass);$('#'+options.boxId).find('li').eq(current).addClass(options.liclass);$target.val($('#'+options.boxId).find('li').eq(current).html());}
function showlist($data){var div,html='<ul>';$('#'+options.boxId).length?div=$('#'+options.boxId):div=$('<div></div>').attr('id',options.boxId).css({position:"absolute",left:offset.left+'px',top:offset.top+height+2+'px',width:width+'px'}).hide();html='<ul>';for(var i=0;i<$data.length;i++){html+='<li>'+$data[i]+'</li>';}
html+='</ul>';$('#'+options.boxId).length?'':$('body').append(div);div.html(html).show();}});$target.unbind('click').click(function(){$('#'+options.boxId).show();});$('#'+options.boxId).find('li').die('click').live('click',(function(){$target.val($(this).html());$('#'+options.boxId).hide();}));$('#'+options.boxId).find('li').die('mouseover').live('mouseover',(function(){$('#'+options.boxId).find('li').removeClass(options.liclass);$(this).addClass(options.liclass);})).unbind('mouseout').live('mouseout',(function(){$('#'+options.boxId).find('li').removeClass(options.liclass);current=-1;}));});